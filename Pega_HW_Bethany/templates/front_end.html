<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Demo_Bethany</title>
    <link href="../static/css/front_end.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="header">
        <div class="logo-container">
            <img src="../logo2.png" alt="Logo" style="height: 100px;">
            <h1 class="page-title"> User Management System</h1>
        </div>
    </div>

    <div id="app" style="margin-top: 60px;">

        <div class="section-header with-search">
            <div class="left">
              <h2>ä½¿ç”¨è€…æ¸…å–®ï¼ˆImageï¼‰</h2>
            </div>
            <div class="right">
              <label class="search-label">æœå°‹ï¼š
                <input type="text" v-model="searchInput" @input="debouncedSearch" placeholder="ğŸ” æœå°‹è·æ¥­ã€å§“å..." class="search-input">
              </label>
              <button @click="openModal" class="add-user-btn">ï¼‹ æ–°å¢ä½¿ç”¨è€…</button>
            </div>
          </div>


        <div class="card-container">
            <div class="card" v-for="user in paginatedUsersCard" :key="user.id">
                 <!-- å·¦ä¸Šè§’çš„å‰å‰ -->
                <button @click="editUser(user)" class="edit-btn">ç·¨è¼¯</button>
                <button class="delete-btn" @click="confirmDeleteUser(user.id)">åˆªé™¤</button>
                <!-- <img :src="getUserImage(user)" alt="é ­åƒ" class="avatar"> -->
                <img :src="getUserImage(user)" class="avatar">
                <div class="name">{{ user.name }}</div>
                <div class="info">æ€§åˆ¥ï¼š{{ user.gender }}</div>
                <div class="info">ç”Ÿæ—¥ï¼š{{ user.birthday }}</div>
                <div class="info">è·æ¥­ï¼š{{ user.job }}</div>
                <div class="info">é›»è©±ï¼š{{ user.phone }}</div>
            </div>
        </div>

        <div class="pagination">
            <button @click="cardPage--" :disabled="cardPage === 1">ä¸Šä¸€é </button>
            <button @click="cardPage++" :disabled="cardPage * pageSize >= filteredUsers.length">ä¸‹ä¸€é </button>
        </div>

        <div v-if="showModal" class="modal-overlay">
            <div class="modal-content">
                <h3 style="text-align: center;">{{ editingUser ? 'ç·¨è¼¯ä½¿ç”¨è€…è³‡è¨Š' : 'æ–°å¢ä½¿ç”¨è€…' }}</h3>
                <label>å§“åï¼š<input v-model="form.name" placeholder="è«‹è¼¸å…¥å§“å"></label>
                <label>æ€§åˆ¥ï¼š<input v-model="form.gender" placeholder="è«‹è¼¸å…¥æ€§åˆ¥"></label>
                <label>ç”Ÿæ—¥ï¼š<input v-model="form.birthday" type="date" placeholder="è«‹é¸æ“‡ç”Ÿæ—¥"></label>
                <label>è·æ¥­ï¼š
                    <select v-model="form.job">
                        <option disabled value="">è«‹é¸æ“‡è·æ¥­</option>
                        <option>å­¸ç”Ÿ</option>
                        <option>å·¥ç¨‹å¸«</option>
                        <option>æ•™å¸«</option>
                        <option>ç„¡æ¥­</option>
                    </select>
                </label>
                <label>é›»è©±ï¼š<input v-model="form.phone" placeholder="è«‹è¼¸å…¥é›»è©±"></label>
                <label v-if="!modalFromTable"> é ­åƒï¼š
                    <input type="file" @change="onImageUpload">
                </label>
                <div class="modal-actions">
                    <button @click="saveUser">å„²å­˜</button>
                    <button @click="closeModal">å–æ¶ˆ</button>
                </div>
            </div>
        </div>

        <br></br>
        <br></br>

        <!-- table -->
        <div class="section-header with-search">
            <div class="left">
              <h2>ä½¿ç”¨è€…æ¸…å–®ï¼ˆTableï¼‰</h2>
            </div>
            <div class="right">
              <label class="search-label">æœå°‹ï¼š
                <input type="text" v-model="searchInput" @input="debouncedSearch" placeholder="ğŸ” æœå°‹è·æ¥­ã€å§“å..." class="search-input">
              </label>
              <button @click="openModal" class="add-user-btn">ï¼‹ æ–°å¢ä½¿ç”¨è€…</button>
            </div>
          </div>
          
        <table class="user-table">
            <thead>
                <tr>
                    <th>å§“å</th>
                    <th>æ€§åˆ¥</th>
                    <th>ç”Ÿæ—¥</th>
                    <th>è·æ¥­</th>
                    <th>é›»è©±</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="user in paginatedUsersTable" :key="user.id">
                    <td>{{ user.name }}</td>
                    <td>{{ user.gender }}</td>
                    <td>{{ user.birthday }}</td>
                    <td>{{ user.job }}</td>
                    <td>{{ user.phone }}</td>
                    <td>
                        <button @click="editUser(user, true)">ç·¨è¼¯</button>
                        <button @click="confirmDeleteUser(user.id)">åˆªé™¤</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <div v-if="confirmDelete" class="modal-overlay">
            <div class="modal-content">
                <h3 style="text-align: center;">ç¢ºå®šè¦åˆªé™¤å—ï¼Ÿ</h3>
                <div class="modal-actions" style="text-align: center; margin-top: 20px;">
                    <button @click="deleteConfirmed"
                        style="background-color:rgb(160, 130, 100) ; color: white;">æ˜¯</button>
                    <button @click="cancelDelete" style="background-color:rgb(160, 130, 100) ; color: white;">å¦</button>
                </div>
            </div>
        </div>

        <div class="pagination">
            <button @click="tablePage--" :disabled="tablePage === 1">ä¸Šä¸€é </button>
            <button @click="tablePage++" :disabled="tablePage * pageSize >= filteredUsers.length">ä¸‹ä¸€é </button>
        </div>

        <!-- æ–°å¢æˆåŠŸæç¤ºè¦–çª— -->
        <div v-if="showSuccessModal" class="modal-overlay">
            <div class="modal-content">
            <!-- <h3 style="text-align: center;">æ–°å¢æˆåŠŸï¼</h3> -->
            <h3 style="text-align: center;">{{ successMessage }}</h3>
            <div class="modal-actions" style="text-align: center; margin-top: 20px;">
                <button @click="closeSuccessModal" style="background-color: #a08264; color: white;">é—œé–‰</button>
            </div>
            </div>
        </div>

        <!-- éŒ¯èª¤æç¤ºè¦–çª— -->
        <div v-if="showErrorModal" class="modal-overlay">
            <div class="modal-content">
            <h3 style="text-align: center;">"å§“å"ç‚ºå¿…å¡«æ¬„ä½</h3>
            <div class="modal-actions" style="text-align: center; margin-top: 20px;">
                <button @click="closeErrorModal" style="background-color: #a08264; color: white;">é—œé–‰</button>
            </div>
            </div>
        </div>
  
        
    </div>
    <br></br>
    <br></br>

    <script src="../static/js/Vue.js"></script>
    <script src="../static/js/moment.min.js"></script>
    <script src="../static/js/axios.js"></script>
    <script src="../static/js/jquery.js"></script>
    <script src="../static/js/front_end.js"></script>
</body>

</html>